webpackJsonp([6],{"/4Xe":function(e,t,o){var n=o("ll5v");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);o("skYq")("31818b60",n,!0)},"1Jov":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o("m1CX"),r=o.n(n),i=o("gyMJ"),a={components:{},data:function(){var e;return e={dialogloading:!1,treeLoading:!0,input:"",stepActive:0,dialog:!1,dialogUpload:!1,sectionName:"",isEditorStatus:!1,next:!1,formLabelWidth:"80px",courseChapterForm:{title:"",courseChapterId:""},courseSectionForm:{title:"",videoUrl:"",courseSectionId:"",videoMinute:"",videoSecond:""},nodeForm:{title:"title",thumb:"",video:"",minute:22,second:11},currentCourseChapterRow:{},courseChapterData:[],courseChapterRules:{}},r()(e,"courseChapterRules",{title:[{required:!0,message:"请输入课程章名",trigger:"blur"}]}),r()(e,"courseSectionFormRules",{title:[{required:!0,message:"请输入视频名称",trigger:"blur"}],videoUrl:[{required:!0,message:"请上传视频",trigger:"blur"}]}),e},mounted:function(){},computed:{},created:function(){var e=this.$route,t=e.params.cid;console.log(e),t&&(this.getCourseChapterListHandle(t),this.cid=t),console.log("子组件",this.cid)},methods:{getCourseChapterListHandle:function(e){var t=this;Object(i.j)({courseSubjectId:e}).then(function(e){console.log("获取章节列表",e),0===e.code&&(e.data&&e.data.length&&(t.courseChapterData=t.formartCourseChapterList(e.data),console.log(t.courseChapterData)),t.treeLoading=!1,t.dialogUpload=!1)})},getCourseSectionListHandle:function(e){Object(i.k)({courseChapterId:e}).then(function(e){console.log("获取节信息",e)})},formartCourseChapterList:function(e){for(var t=0;t<e.length;t++)e[t].label=e[t].courseChapterTitle,e[t].type="chapter",e[t].index=t,e[t].courseSections&&e[t].courseSections.length&&(e[t].children=this.initCourseSectionList(e[t].courseSections,t));return e},createCourseChapterHandle:function(e,t,o){Object(i.b)({courseSubjectId:e,courseChapterTitle:t}).then(function(e){0===e.code&&o(e.data)})},chapterFormSubmit:function(e){var t=this,o=t.courseChapterForm.title;t.onRuleForm(e,function(){if(t.dialogLoading=!0,t.isEditorStatus)t.currentCourseChapterRow.label=o,t.putCourseChapterHandle(t.cid,t.courseChapterForm.courseChapterId,o,function(){t.dialogLoading=!1});else{var e=t.formartCourseChapter(o);t.createCourseChapterHandle(t.cid,o,function(){t.dialogLoading=!1,t.courseChapterData.push(e)})}t.dialog=!1,t.isEditorStatus=!1})},formartCourseChapter:function(e){var t=this.courseChapterData.length;return{label:e,index:t,id:t,type:"chapter"}},addSection:function(e){this.dialog=!0,"create"===e&&(this.isEditorStatus=!1)},addClass:function(e){console.log("当前数据",e);this.courseChapterForm=e,this.dialogUpload=!0},initCourseSectionList:function(e,t){for(var o=0;o<e.length;o++)e[o].label=e[o].courseSectionTitle,e[o].index=o,e[o].type="section",e[o].order=t+1;return e},deleteHandle:function(e,t){"chapter"===t.type?this.deleteChapterHandle(e,t):"section"===t.type&&this.deleteSectionHandle(e,t),console.log("删除数据",t)},deleteSectionHandle:function(e,t){var o=this,n=e.parent,r=n.data.children||n.data,a=r.findIndex(function(e){return e.id===t.id});o.confirm({},function(){Object(i.g)({id:t.id}).then(function(e){0===e.code?(r.splice(a,1),o.$message({type:"success",message:"删除成功!"})):o.$message({type:"success",message:e.message})})})},deleteChapterHandle:function(e,t){var o=this,n=e.parent,r=n.data.children||n.data,a=r.findIndex(function(e){return e.id===t.id});o.confirm({},function(){Object(i.f)({id:t.id}).then(function(e){0===e.code?(r.splice(a,1),o.$message({type:"success",message:"删除成功!"})):o.$message({type:"success",message:e.message})})})},formartCourseSectionData:function(){return{courseSectionId:this.courseSectionForm.courseSectionId||"",courseChapterId:this.courseChapterForm.courseChapterId||"",courseSubjectId:this.cid,courseSectionTitle:this.courseSectionForm.title||"",courseSectionVideoFileid:"string",courseSectionVideoName:"string",courseSectionVideoUrl:"string",courseSectionVideoCoverName:"string",courseSectionVideoCoverUrl:"string",courseSectionVideoSeconds:90}},createCourseSectionHandle:function(e){Object(i.c)(this.formartCourseSectionData()).then(function(t){0===t.code&&e(t.data)})},editorChapterHandle:function(e,t){this.dialog=!0,this.isEditorStatus=!0,this.courseChapterForm.title=t.label,this.courseChapterForm.courseChapterId=t.courseChapterId,this.currentCourseChapterRow=t},putCourseChapterHandle:function(e,t,o,n){Object(i.o)({courseSubjectId:e,courseChapterId:t,courseChapterTitle:o}).then(function(e){0===e.code&&(n(e.data),console.log("修改章节标题成功"))})},courseSectionFormHandel:function(e){var t=this;t.courseChapterForm;t.onRuleForm(e,function(){t.dialogloading=!0,t.createCourseSectionHandle(function(e){t.getCourseChapterListHandle(t.cid),t.dialogloading=!1})})},onRuleForm:function(e,t){this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t()})},closedChapterForm:function(e){console.log("关闭的回调"),this.$refs[e].resetFields()},confirm:function(e,t){this.$confirm("此操作将永久删除该信息，你确定删除吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t()}).catch(function(){})}}},s={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"ds-course-chapter app-container"},[n("el-tabs",{staticClass:"ds-tabs",attrs:{type:"border-card"}},[n("el-tab-pane",{attrs:{label:"课件信息"}},[n("el-row",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addSection("create")}}},[e._v("添加章")]),e._v(" "),n("div",{staticClass:"ds-block",staticStyle:{"padding-top":"10px","font-size":"12px",color:"#999"}},[e._v("\n                注：请先添加课程的章，然后在添加课程的节（只有节才可以设置课件）。\n            ")])],1),e._v(" "),n("div",{staticClass:"block"},[n("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.treeLoading,expression:"treeLoading"}],attrs:{data:e.courseChapterData,"node-key":"id","empty-text":"你还没有增加任何课件","default-expand-all":"","expand-on-click-node":!1},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.node,r=t.data;return n("span",{staticClass:"custom-tree-node"},[["chapter"==r.type?n("span",[e._v("第"+e._s(r.index+1)+"章："+e._s(o.label))]):n("span",[e._v(e._s(r.order)+"-"+e._s(r.index+1)+"："+e._s(o.label))])],e._v(" "),n("span",["chapter"==r.type?n("el-button",{attrs:{type:"text"},on:{click:function(t){e.addClass(r)}}},[e._v("添加课件")]):e._e(),e._v(" "),["chapter"==r.type?n("el-button",{attrs:{type:"text"},on:{click:function(t){e.editorChapterHandle(o,r)}}},[e._v("编辑 ")]):n("el-button",{attrs:{type:"text"},on:{click:function(t){e.addClass(r)}}},[e._v("编辑 ")])],e._v(" "),n("el-button",{attrs:{type:"text"},on:{click:function(t){e.deleteHandle(o,r)}}},[e._v("删除")])],2)],2)}}])})],1),e._v(" "),n("el-dialog",{attrs:{title:"添加章",visible:e.dialog,width:"50%"},on:{"update:visible":function(t){e.dialog=t},close:function(t){e.closedChapterForm("courseChapterForm")}}},[n("el-form",{ref:"courseChapterForm",staticClass:"ds-course-chapter-dialog",attrs:{model:e.courseChapterForm,rules:e.courseChapterRules}},[n("el-form-item",{attrs:{label:"标题","label-width":e.formLabelWidth,prop:"title"}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:e.courseChapterForm.title,callback:function(t){e.$set(e.courseChapterForm,"title",t)},expression:"courseChapterForm.title"}})],1)],1),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary",loading:e.dialogloading},on:{click:function(t){e.chapterFormSubmit("courseChapterForm")}}},[e._v("确 定")]),e._v(" "),n("el-button",{on:{click:function(t){e.dialog=!1}}},[e._v("取 消")])],1)],1),e._v(" "),n("el-dialog",{attrs:{title:"添加课件",visible:e.dialogUpload,width:"700px"},on:{"update:visible":function(t){e.dialogUpload=t},close:function(t){e.closedChapterForm("courseSectionForm")}}},[n("div",{staticClass:"add-content"},[n("el-form",{ref:"courseSectionForm",attrs:{model:e.courseSectionForm,rules:e.courseSectionFormRules,"label-width":"100px"}},[n("div",{staticClass:"head"},[n("el-steps",{attrs:{"align-center":"",active:e.stepActive,"finish-status":"success"}},[n("el-step",{attrs:{title:"选择课件类型"}}),e._v(" "),n("el-step",{attrs:{title:"设置课件内容"}})],1)],1),e._v(" "),e.next?e._e():n("div",{staticClass:"middle"},[n("img",{attrs:{src:o("ph3F"),alt:""}}),e._v(" "),n("p",[e._v("视频")])]),e._v(" "),e.next?n("div",{staticClass:"middle-form"},[n("el-form-item",{attrs:{label:"标题",prop:"title"}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:e.courseSectionForm.title,callback:function(t){e.$set(e.courseSectionForm,"title",t)},expression:"courseSectionForm.title"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"视频",prop:"videoUrl"}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:e.courseSectionForm.videoUrl,callback:function(t){e.$set(e.courseSectionForm,"videoUrl",t)},expression:"courseSectionForm.videoUrl"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"视频时间",prop:"videoMinute"}},[n("el-col",{staticStyle:{"margin-right":"20px"},attrs:{span:5}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:e.courseSectionForm.videoMinute,callback:function(t){e.$set(e.courseSectionForm,"videoMinute",t)},expression:"courseSectionForm.videoMinute"}},[n("template",{slot:"append"},[e._v("分")])],2)],1),e._v(" "),n("el-col",{attrs:{span:5}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:e.courseSectionForm.videoSecond,callback:function(t){e.$set(e.courseSectionForm,"videoSecond",t)},expression:"courseSectionForm.videoSecond"}},[n("template",{slot:"append"},[e._v("秒")])],2)],1)],1)],1):e._e()])],1),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.next?e._e():n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.next=!0}}},[e._v("下一步")]),e._v(" "),e.next?n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.next=!1}}},[e._v("上一步")]):e._e(),e._v(" "),e.next?n("el-button",{attrs:{type:"primary",loading:e.dialogloading},on:{click:function(t){e.courseSectionFormHandel("courseSectionForm")}}},[e._v("保存")]):e._e()],1)])],1)],1)],1)},staticRenderFns:[]};var c=o("toHq")(a,s,!1,function(e){o("/4Xe")},null,null);t.default=c.exports},ll5v:function(e,t,o){(e.exports=o("kkNj")(!1)).push([e.i,"\n.ds-course-chapter {\n  text-align: left;\n}\n.ds-course-chapter .el-steps {\n    width: 100%;\n}\n.ds-course-chapter .el-tree {\n    border-bottom: 1px solid #ddd;\n}\n.ds-course-chapter .block {\n    padding-top: 20px;\n    font-size: 18px;\n}\n.ds-course-chapter .block .el-tree-node__content {\n      padding-top: 10px;\n      padding-bottom: 10px;\n      border: 1px solid #ddd;\n      border-bottom: 0;\n      display: -webkit-box;\n      display: -ms-flexbox;\n      display: flex;\n      height: 45px;\n}\n.ds-course-chapter .block .custom-tree-node {\n      -webkit-box-flex: 1;\n          -ms-flex: 1;\n              flex: 1;\n      display: -webkit-box;\n      display: -ms-flexbox;\n      display: flex;\n      -webkit-box-align: center;\n          -ms-flex-align: center;\n              align-items: center;\n      -webkit-box-pack: justify;\n          -ms-flex-pack: justify;\n              justify-content: space-between;\n      padding-right: 10px;\n}\n.ds-course-chapter .block .el-checkbox {\n      margin-top: 8px;\n}\n.ds-course-chapter .ds-course-chapter-dialog {\n    padding-right: 50px;\n}\n.ds-course-chapter .add-content .head {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    padding-bottom: 50px;\n}\n.ds-course-chapter .add-content .head .head-child {\n      display: -webkit-box;\n      display: -ms-flexbox;\n      display: flex;\n      -webkit-box-align: center;\n          -ms-flex-align: center;\n              align-items: center;\n      width: 45%;\n      -webkit-box-pack: center;\n          -ms-flex-pack: center;\n              justify-content: center;\n}\n.ds-course-chapter .add-content .head .head-child p {\n        width: 40px;\n        height: 40px;\n        text-align: center;\n        line-height: 42px;\n        background: #409EFF;\n        color: #fff;\n        font-size: 28px;\n        border-radius: 50%;\n}\n.ds-course-chapter .add-content .head .head-child div {\n        margin-left: 20px;\n        font-size: 16px;\n}\n.ds-course-chapter .add-content .middle {\n    position: relative;\n    background: #ddd;\n    width: 140px;\n    height: 140px;\n    margin-left: 75px;\n    margin-top: 20px;\n    text-align: center;\n}\n.ds-course-chapter .add-content .middle img {\n      width: 40px;\n      height: 40px;\n      margin-top: 40px;\n}\n.ds-course-chapter .add-content .middle span {\n      position: relative;\n}\n.ds-course-chapter .add-content .middle-form {\n    padding-right: 50px;\n}\n",""])}});